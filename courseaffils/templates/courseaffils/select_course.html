{% extends "base.html" %}
{% load coursetags %}

{% block content %}

{% if add_privilege %}
<p class="create-course">
   <a href="{%url admin:courseaffils_course_add %}">Create a course</a>
</p>
{% endif %}
{% if user.is_staff %}
<p>Staff: To demo a class you can (mostly) anonymize the class, by setting this cookie:
</p>
<ul>
  <li>
    <span id="anonymize_status"></span>
    <a href="#anonymize" onclick="document.cookie='ANONYMIZE=on; path=/';anonymizeStatus();">Enable</a>
    <a href="#anonymize" onclick="document.cookie='ANONYMIZE=OFF; expires='+new Date().toGMTString()+'; path=/';anonymizeStatus();">Disable</a>
  </li>
</ul>
<script type="text/javascript">
  function anonymizeStatus() {
  document.getElementById('anonymize_status').innerHTML = 'Anonymizing Status: '
  + ((document.cookie.match(/ANONYMIZE/)) ? 'ON' : 'OFF');
  }
  anonymizeStatus();
</script>

{% endif %}

<p>
  Hello, {{user.get_full_name|default:user}}!  Please select a course:
</p>

<table class="course-choices">
  <thead>
    <tr>
      <td>Course Titles
        {% if not list_all_link %}
          from this year (<a href="?list_all=true{{next_redirect}}">see courses from previous years</a>)
        {% else %}
          (<a href="?{{next_redirect}}">filter courses for this year</a>)
        {% endif %}
      </td>
      <td>Term</td>
      <td>Instructor</td>
      <td>Role</td> 
      {% if add_privilege %} 
        <td>Staff</td>
      {% endif %}    
    </tr>
  </thead>
  <tbody>
{% for course in courses %}
 <tr><td class="course-choice">
  <a class="choose-course" href="?set_course={{course.group.name|urlencode}}{{next_redirect}}">{{course.title}}</a>
  </td>
  <td>{{course.info.termyear}}</td>
  <td>{% if course.details.instructor %}{{course.details.instructor.value}}{% endif %}</td>
  <td>{% course_role for request.user in course as foo %}{{foo}}</td>
  {% if add_privilege %}
     <td class="manage-course">  
       <a href="{%url admin:courseaffils_course_change course.id %}">manage</a>
     </td>
     <td>{{course.info.time}}</td>  
  {% endif %}
 </tr>
{% endfor %}

{% if not list_all_link %}
<tr class="course-choices-other-years">
  <td colspan="5">
      <a href="?list_all=true{{next_redirect}}">See your courses from previous years</a>
  </td>
</tr>
{% endif %}

</tbody>
</table>
{% endblock %}
